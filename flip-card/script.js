const c=document.getElementById('gameCanvas'),ctx=c.getContext('2d');c.width=640;c.height=480;let gameRunning=false,moves=0,pairs=0,cards=[],flipped=[],matched=[],startTime=0,timer;const COLORS=['#e74c3c','#3498db','#2ecc71','#f39c12','#9b59b6','#1abc9c','#e67e22','#34495e'];function init(){cards=[];const nums=[...COLORS,...COLORS].sort(()=>Math.random()-0.5);for(let i=0;i<16;i++)cards.push({id:i,color:nums[i],x:(i%4)*150+20,y:Math.floor(i/4)*110+20,flipped:false,matched:false})}function draw(){ctx.fillStyle='#ecf0f1';ctx.fillRect(0,0,c.width,c.height);cards.forEach(card=>{if(card.matched){ctx.fillStyle='#2c3e50';ctx.globalAlpha=0.3}else if(card.flipped){ctx.fillStyle=card.color;ctx.globalAlpha=1}else{ctx.fillStyle='#34495e';ctx.globalAlpha=1}ctx.fillRect(card.x,card.y,130,90);ctx.strokeStyle='#2c3e50';ctx.lineWidth=3;ctx.strokeRect(card.x,card.y,130,90);ctx.globalAlpha=1})}c.addEventListener('click',e=>{if(!gameRunning||flipped.length>=2)return;const rect=c.getBoundingClientRect(),x=(e.clientX-rect.left)*(c.width/rect.width),y=(e.clientY-rect.top)*(c.height/rect.height);cards.forEach(card=>{if(x>=card.x&&x<=card.x+130&&y>=card.y&&y<=card.y+90&&!card.flipped&&!card.matched){card.flipped=true;flipped.push(card);if(flipped.length===2){moves++;document.getElementById('moves').textContent=moves;setTimeout(()=>{if(flipped[0].color===flipped[1].color){flipped[0].matched=true;flipped[1].matched=true;matched.push(flipped[0],flipped[1]);pairs++;document.getElementById('pairs').textContent=`${pairs}/8`;if(pairs===8){clearInterval(timer);const elapsed=Math.floor((Date.now()-startTime)/1000);document.getElementById('finalTime').textContent=`${Math.floor(elapsed/60)}:${(elapsed%60).toString().padStart(2,'0')}`;document.getElementById('finalMoves').textContent=moves;document.getElementById('gameOver').classList.remove('hidden');gameRunning=false}}else{flipped[0].flipped=false;flipped[1].flipped=false}flipped=[];draw()},800)}draw()}})});function updateTime(){const elapsed=Math.floor((Date.now()-startTime)/1000);document.getElementById('time').textContent=`${Math.floor(elapsed/60)}:${(elapsed%60).toString().padStart(2,'0')}`}document.getElementById('startBtn').addEventListener('click',()=>{gameRunning=true;moves=0;pairs=0;flipped=[];matched=[];document.getElementById('instructions').classList.add('hidden');document.getElementById('moves').textContent=0;document.getElementById('pairs').textContent='0/8';startTime=Date.now();timer=setInterval(updateTime,1000);init();draw()});document.getElementById('restartBtn').addEventListener('click',()=>{moves=0;pairs=0;flipped=[];matched=[];gameRunning=true;document.getElementById('gameOver').classList.add('hidden');document.getElementById('moves').textContent=0;document.getElementById('pairs').textContent='0/8';startTime=Date.now();timer=setInterval(updateTime,1000);init();draw()});

