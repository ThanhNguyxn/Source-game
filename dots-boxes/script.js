const canvas=document.getElementById('gameCanvas');const ctx=canvas.getContext('2d');canvas.width=500;canvas.height=500;let gameRunning=false,paused=false,gameStarted=false,playerScore=0,aiScore=0,currentPlayer=0;const GRID=5,DOT_SIZE=10,SPACING=80,OFFSET=60;let lines=[],boxes=[];function init(){lines=[];boxes=[];for(let r=0;r<GRID;r++){boxes[r]=[];for(let c=0;c<GRID-1;c++)boxes[r][c]={top:false,bottom:false,left:false,right:false,owner:null}}}function draw(){ctx.fillStyle='#f0f0f0';ctx.fillRect(0,0,canvas.width,canvas.height);for(let r=0;r<GRID;r++){for(let c=0;c<GRID;c++){ctx.fillStyle='#333';ctx.beginPath();ctx.arc(OFFSET+c*SPACING,OFFSET+r*SPACING,DOT_SIZE,0,Math.PI*2);ctx.fill()}}boxes.forEach((row,r)=>row.forEach((box,c)=>{if(box.owner!==null){ctx.fillStyle=box.owner===0?'rgba(78,205,196,0.5)':'rgba(255,107,107,0.5)';ctx.fillRect(OFFSET+c*SPACING+DOT_SIZE,OFFSET+r*SPACING+DOT_SIZE,SPACING-DOT_SIZE*2,SPACING-DOT_SIZE*2)}if(box.top){ctx.strokeStyle='#333';ctx.lineWidth=4;ctx.beginPath();ctx.moveTo(OFFSET+c*SPACING,OFFSET+r*SPACING);ctx.lineTo(OFFSET+(c+1)*SPACING,OFFSET+r*SPACING);ctx.stroke()}if(box.left){ctx.beginPath();ctx.moveTo(OFFSET+c*SPACING,OFFSET+r*SPACING);ctx.lineTo(OFFSET+c*SPACING,OFFSET+(r+1)*SPACING);ctx.stroke()}if(c===GRID-2){if(box.right){ctx.beginPath();ctx.moveTo(OFFSET+(c+1)*SPACING,OFFSET+r*SPACING);ctx.lineTo(OFFSET+(c+1)*SPACING,OFFSET+(r+1)*SPACING);ctx.stroke()}}if(r===GRID-2){if(box.bottom){ctx.beginPath();ctx.moveTo(OFFSET+c*SPACING,OFFSET+(r+1)*SPACING);ctx.lineTo(OFFSET+(c+1)*SPACING,OFFSET+(r+1)*SPACING);ctx.stroke()}}}))}function checkBox(r,c){if(r<0||c<0||r>=GRID-1||c>=GRID-1)return false;const box=boxes[r][c];if(box.top&&box.bottom&&box.left&&box.right&&box.owner===null){box.owner=currentPlayer;currentPlayer===0?playerScore++:aiScore++;updateDisplay();return true}return false}canvas.addEventListener('click',e=>{if(!gameRunning||paused||currentPlayer!==0)return;const rect=canvas.getBoundingClientRect();const x=e.clientX-rect.left,y=e.clientY-rect.top;for(let r=0;r<GRID-1;r++){for(let c=0;c<GRID-1;c++){const ox=OFFSET+c*SPACING,oy=OFFSET+r*SPACING;if(Math.abs(y-oy)<15&&x>=ox&&x<=ox+SPACING){if(!boxes[r][c].top){boxes[r][c].top=true;let scored=checkBox(r,c);if(r>0)scored=checkBox(r-1,c)||scored;if(!scored)setTimeout(aiMove,500);draw();return}}if(Math.abs(y-(oy+SPACING))<15&&x>=ox&&x<=ox+SPACING){if(!boxes[r][c].bottom){boxes[r][c].bottom=true;if(r<GRID-2)boxes[r+1][c].top=true;let scored=checkBox(r,c);if(!scored)setTimeout(aiMove,500);draw();return}}if(Math.abs(x-ox)<15&&y>=oy&&y<=oy+SPACING){if(!boxes[r][c].left){boxes[r][c].left=true;let scored=checkBox(r,c);if(c>0)scored=checkBox(r,c-1)||scored;if(!scored)setTimeout(aiMove,500);draw();return}}if(Math.abs(x-(ox+SPACING))<15&&y>=oy&&y<=oy+SPACING){if(!boxes[r][c].right){boxes[r][c].right=true;if(c<GRID-2)boxes[r][c+1].left=true;let scored=checkBox(r,c);if(!scored)setTimeout(aiMove,500);draw();return}}}}});function aiMove(){if(!gameRunning||paused)return;currentPlayer=1;document.getElementById('turn').textContent='AI';const moves=[];for(let r=0;r<GRID-1;r++){for(let c=0;c<GRID-1;c++){const b=boxes[r][c];if(!b.top)moves.push({r,c,side:'top'});if(!b.bottom)moves.push({r,c,side:'bottom'});if(!b.left)moves.push({r,c,side:'left'});if(!b.right)moves.push({r,c,side:'right'})}}if(moves.length>0){const move=moves[Math.floor(Math.random()*moves.length)];boxes[move.r][move.c][move.side]=true;if(move.side==='bottom'&&move.r<GRID-2)boxes[move.r+1][move.c].top=true;if(move.side==='right'&&move.c<GRID-2)boxes[move.r][move.c+1].left=true;let scored=checkBox(move.r,move.c);if(move.side==='top'&&move.r>0)scored=checkBox(move.r-1,move.c)||scored;if(move.side==='left'&&move.c>0)scored=checkBox(move.r,move.c-1)||scored;draw();if(!scored){currentPlayer=0;document.getElementById('turn').textContent='You'}else setTimeout(aiMove,700)}else gameOver()}function updateDisplay(){document.getElementById('playerScore').textContent=playerScore;document.getElementById('aiScore').textContent=aiScore}function gameOver(){gameRunning=false;document.getElementById('winnerText').textContent=playerScore>aiScore?'üéâ You Win!':playerScore<aiScore?'AI Wins!':'Draw!';document.getElementById('finalPlayer').textContent=playerScore;document.getElementById('finalAI').textContent=aiScore;document.getElementById('gameOver').classList.remove('hidden')}document.getElementById('startBtn').addEventListener('click',()=>{if(!gameStarted){gameStarted=true;gameRunning=true;document.getElementById('instructions').classList.add('hidden');document.getElementById('pauseBtn').disabled=false;playerScore=0;aiScore=0;currentPlayer=0;init();updateDisplay();draw()}});document.getElementById('pauseBtn').addEventListener('click',()=>{paused=!paused;document.getElementById('pauseBtn').textContent=paused?'‚ñ∂Ô∏è Resume':'‚è∏ Pause'});document.getElementById('restartBtn').addEventListener('click',()=>{playerScore=0;aiScore=0;currentPlayer=0;gameRunning=true;paused=false;init();document.getElementById('gameOver').classList.add('hidden');updateDisplay();draw()});window.addEventListener('keydown',e=>{if(e.key==='p'||e.key==='P'){e.preventDefault();paused=!paused;document.getElementById('pauseBtn').textContent=paused?'‚ñ∂Ô∏è Resume':'‚è∏ Pause'}});updateDisplay();

